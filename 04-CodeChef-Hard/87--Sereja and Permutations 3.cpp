#include <bits/stdc++.h>

constexpr int64_t P = 2000000011;

constexpr int64_t Fac[] = {1,737010027,607667727,1551713662,1642217365,244386806,1624055472,60749064,94271961,1442283566,147095621,1711715539,1727541586,291695190,1346344892,198524642,331160101,1991995891,301057891,1493674748,363886615,1514330957,1987124224,364505937,1409282799,1075620809,368437411,1318698875,593826273,186119613,333254220,644801400,509444711,685790067,1211715078,1180915644,1308348013,536079740,1785902096,1571632996,1817329888,704765174,983597713,1075976007,1309467485,1063963776,81700346,914323284,1330889160,1049055229,1310220784,1713934239,1533399135,1995907400,1881120715,1171962356,1036768739,1000343990,1754894311,294738668,1401794564,312554968,337270174,880895922,1530060790,1572497702,22165024,1881902531,1066107203,1714824009,996629994,1866881301,1128623775,1253333590,735135011,612295834,1949954028,1380527333,300509461,1807712477,1568515239,683874911,1983582649,1753579949,1319728558,1862320617,1095744205,1422628247,929600460,1704737804,1879561251,416758808,145022271,515694733,1969792247,1240838522,1218693110,427810192,655080739,1218230277,1340732255,1966012500,533300461,988903424,1947525551,115459107,1478521102,534078235,197249671,1558863348,555351542,1858956960,1785934018,536385799,1665145136,1527382729,1360156276,1140702245,143617633,1504177147,1841365283,1692751857,403201785,85107005,1052754406,978620489,247697835,954792337,971831570,1166665930,1797943549,171982267,755540885,557198770,1931894428,99775572,1443855456,497448554,1326237169,549915325,114423256,1168989154,893946381,1570857973,811756209,87103616,1721273350,1051168815,1624436970,921273841,1728581997,671542768,1713343151,1945913676,1146428215,925204481,145284135,1922830102,1912257926,579226076,1710013049,354146344,1571683164,1164859308,1440540865,637374457,1024038449,1056308030,766572030,386794020,1664632453,515553579,1488140624,537526843,176046322,487111856,1349622707,1081160947,1402597280,785856836,873111513,239205239,836373419,877960193,99914173,1013315389,820650816,1542936420,956225454,464931071,366027197,958328911,385979448,397178392,84856854,860996742,14966926,1799007035,1492196851,1149782076,422470864,1062910127,1192713852,1759131259,1007151797,1356060473,111896794,1864224273,1136246490,1443485316,655218789,129843142,1477858728,103559055,194405702,374227403,33891945,755501538,1239338753,1930871872,864841454,91841623,823799202,1766134848,304629586,1661625181,1952928998,1369160914,194047638,1431093475,1223143452,70593303,1112260403,67305572,72862482,1927259347,1735842018,300155620,1857622849,403152286,949541789,485335263,1833320317,945057571,902098216,1404681661,957131575,940020448,927145100,570810150,357463885,913664457,1052356684,118320216,1648405384,1774327912,1488620941,1577873797,1657826668,1449982999,914199643,603088129,899982237,326752926,1467584533,1852274544,1081211087,1928421716,1028654966,1144920465,1240413403,1587746238,36093404,522944261,629338086,1143586068,192770699,895459741,1448497415,1680541480,1504834244,1601145828,915822499,1819480809,1333118658,1894752128,445763938,1098957297,863789006,1830763782,1995308937,1951112537,1686883307,638856144,1076090916,1552589257,623925562,1154620825,1962404050,1293054919,451416412,1675437015,1068059617,499670868,1295723247,616792392,587637116,1662828379,84010507,1086540451,1462545152,1379063844,1999855139,1985407755,977292738,1961639609,26131657,1023294066,786138296,441126337,476982384,1762597273,979755693,1673413706,787583020,1076526005,784109512,1347256191,1321513862,934133050,1773410056,240295180,868608790,819727079,136820935,295868446,926865263,230386150,1954125407,1574781312,995380174,243504491,536538085,1319429826,1580651344,1880719706,667192394,563785183,1646307994,1287004202,186246737,971464436,266288381,144156831,1762815706,510763201,1623517346,344407882,28297416,401853982,285738271,124900831,1538246212,1974803982,550784498,49728155,1442070213,196224231,545303769,1718992869,1685993419,1450782298,11176031,1427087717,1634628955,158672038,713878445,1103142291,44990829,712996126,1047564421,394529211,1178076028,56969397,961681810,746398902,1548746295,147929376,805475657,1104206212,1438953903,1995455644,316555150,1922478683,375496265,1050158690,1120755947,137756602,1518955227,1149630935,1730291751,1839261039,224960766,1210324405,1450113156,639241130,1322112583,1190650697,132664243,1838333612,1960525612,1385696823,1618956031,257735853,1890643613,1147752114,990996040,495632905,472351572,388938330,355963849,1412128703,161753918,1435394095,314101934,1921892008,516249573,836631750,1686177508,396108230,1907565662,1575798862,392999528,417697961,1548738638,671238356,1797860914,565272477,1325397755,930065023,679888167,669569315,1421901071,1765367724,1173942802,1518924841,1618371602,256768938,510043712,767406702,278022192,1758529608,1622426065,1367430509,849164929,19688314,1946601897,1021625618,1442027289,250885192,1003626414,380933309,1168018570,502861913,1856981568,55057744,718723811,765951403,1663018952,959555403,164286470,850338934,80008788,536200761,919759524,88719380,728523007,1054688800,1242669939,1298486522,1968026369,526374020,1814544737,1984844708,659616179,885848735,1695219879,158985020,284654431,218049350,436600787,1868505887,1610685459,734140426,1478126999,1280152261,1645507959,455875086,103473091,329129844,92868707,1921574206,1011345346,401309138,720276531,1227520299,1058302087,158735601,46003406,341407875,853581874,1807106384,1665923094,690669495,213361772,1993280024,287187218,979752279,42822096,1232473794,760038547,1532608747,968233569,71485609,1415439682,1425436054,1357763220,200040581,1230019738,1587634196,431919525,343939708,26459606,941072223,1893968204,1597929693,1848331302,1237154033,513811270,1057684920,1341104556,1087044713,1504775601,408336409,392031906,339201130,1691524854,889698863,1723822257,1376333461,278712690,219013892,261726116,284855209,848348912,1091416313,296678309,1154890259,1723273948,1072576309,517502883,966398494,1323250141,263439347,1173756477,615815943,313409677,1478028207,1807264416,254069928,568615551,172091543,1118537536,220073963,463530231,1975035488,1042532368,1711221909,889449311,646351984,1369387807,643463459,472430845,1545475367,507649244,504850661,1331595205,1168267420,539653656,1740051268,786745708,1652617939,1081644868,1661171081,758099933,1578628091,1804034528,947918032,266270646,1909022923,154431364,884014827,1055534368,510068468,285072852,1679563952,1743115075,211283863,1946976724,1516111126,1918578169,575506395,84721111,323433997,529763555,1574529534,1855654250,985048826,533396852,651378666,1725864818,143951511,609871698,1144334603,593467391,1188218099,1277993896,646734569,1636187344,1073548494,586008991,1884754333,968094368,1823733129,419889490,227777774,1442721284,270317147,553805321,179601680,396419511,1035511825,1007813065,36242827,164542205,1125831125,709029735,897738653,1046644771,1798016563,1149489886,1224018638,1492738079,578399761,1772420458,1083643937,1621939396,909443028,1999475540,1150699972,509976174,37575108,1175588396,1856955860,1285175043,1304212742,210400678,982501956,1628873132,1702168636,1429989268,936866773,1137256457,126946861,1159483837,1031690686,1966888060,483807103,869448093,1445394302,98541368,649101244,809453089,809077536,1643538979,963805238,1946206024,1568904134,684439262,1677659338,34105004,1279047340,472779588,1033566358,215936483,1506882106,573851151,849279277,1396419901,960862729,900233077,1255016456,1417828818,869227410,1434478152,1204422666,250732894,713795936,64082259,492167023,300323779,1447378560,429483441,1627347388,560049525,782387908,659814834,477338711,389085947,687750477,1153555724,1703543728,1578029748,147859728,1662743373,1263580214,1021449647,1229372907,1575714581,270512680,1879721460,117661653,596044567,654145025,275258746,1194894300,373677426,920121122,590816803,100578588,1185340564,1847788640,828049618,475226610,953170901,1555054130,418308421,1318939865,448038974,321289953,1137705289,839913058,295537748,444738446,905193319,858789514,586291803,516976770,715828101,324808902,930357390,405367264,439167308,1701456579,1004902980,1419876873,344732486,352772609,782456235,1334504061,1737199552,237569210,867593313,362306721,1736871520,1512899328,130945831,1615467054,213594541,30126664,1471573826,1763592024,168385485,1603212647,1812293291,770752956,1519116228,1008103481,142301534,466863162,373490698,1777610471,77632751,185557270,1300500658,121649168,139845818,1254212338,1495419212,628723957,1496435175,886453550,1128707863,1931286271,170803726,1241868564,954170998,1816161638,1924125210,1095105456,736043784,244716019,1691488179,1172849018,716672575,71253578,1845028833,1518174141,1742759553,433815842,886244661,883986653,638490223,533550820,1943824353,1412270533,901450921,1496032278,226117453,1455571362,1480123445,1217377573,767185820,1133158371,153421552,1964739327,1799383143,674362432,469981843,22375329,637296345,678100128,1908278755,1970636131,463232147,297628955,1317552887,1131038201,980935067,1835268031,1317394202,1392559948,1349676990,1735508888,683309534,1875624372,1319097370,1700381216,1022525583,804522874,1726165182,112252499,1345156383,1951423347,1465959655,1343488690,278678705,228630396,1049759927,492460567,1152035285,1741947182,1504922033,289674615,818000159,630598932,303318597,741532092,1598240264,1434613776,1730093463,212651407,32403940,234110681,1378980978,563325830,1379947303,312373221,190148682,1979358127,1976515300,229419762,1417898810,583374887,1168261698,488992782,1946862487,1272135169,1179519668,1583361154,578490442,1641916557,752782336,914261463,179188674,666669672,644413012,545536278,1151789586,269902265,758269479,1563405684,1550129727,190970406,431194075,1457927563,1316132182,1460168461,878408667,957110363,429110182,793663848,624870282,1986256142,1391739290,11575390,142149445,1628628746,562175193,1471788093,1369597332,114410816,1483266950,1427055858,420912993,942584840,1860342381,1130605441,408132828,1170691105,765132821,697141784,516491759,1747020638,1238483175,573537244,1282737175,1471755327,1898829005,629555185,396503450,1711066399,624125176,342128213,1632477809,434747467,1340260558,619735269,1485808905,206344823,320117005,348273282,41269604,779679866,841005695,680084586,540701934,376406477,33090166,583612806,397823444,531987104,21268135,1656617197,1143058700,1153445771,1049832218,693239764,450977953,1085461794,897944102,811955961,974482715,534446663,653513143,1676547048,1359995259,1204690536,804668824,705959774,1311703908,847794003,686197798,1343959519,1854044990,923042179,1886905395,1410339523,393245465,1086080159,743002378,562469968,974862892,686557746,1559975950,1940346686,57254947,234860689,172489493,108230064,1278289079,689982986,788932257,941272931,1532895935,724467783,522258581,67782980,1469363907,611338700,529658778,948783064,1594515400,1575199250,1484362829,1369752965,1631477449,710754601,1682498819,913873847,561086805,1223503374,1851742718,1687106297,944267144,280135338,1248912772,416586836,1360699950,1781670779,957369531,159483674,1457100387,1274280496,1022563960,1401158709,484992633,672947480,1116121174,471357287,948299172,529216113,1151241410,286976363,533040089,1682269600,1338196867,1298054049,1357156916,1414617999,1845005758,1527378216,1012843927,132989657,1821813507,1368460791,1836958057,827817820,1535903759,1472462209,1970719734,786438934,1899808309,1946461159,1183916145,100849428,207210835,1598368531,1916556153,1461506512,1397870096,1495066441,1243769897,318668617,1987193060,709467256,1570028797,529952350,305201068,851367750,1869791081,795957793,1032891226,932303749,1675073566,358598286,1449004085,1697698984,487768007,669299073,1585396968,93584305,203389978,1765898903,84534865,264596263,1594807073,502865120,347079741,922162112,1017670282,530140649,775337520,1868542935,1807474133,297809444,269150058,751519813,1533766819,1764661308,234589924,1034122936,475093169,1950078379,1074040345,600410465,1266172527,115307053,1241491645,1674924915,215946448,1771788620,1518306050,556740951,1480178269,313218461,1333706505,67324205,1936222939,1723388187,885803942,1639831038,1666691558,71331265,548097364,256802649,1337945981,373571465,1747408764,1904890521,1407899180,495702917,1941498288,140850917,544413468,158229606,69699034,803210988,291983834,1270625675,1027280954,1887985161,466481538,1554727785,1974676952,371853482,612921624,154885813,349553845,668616579,922936044,792903729,836982326,852109088,859438639,603982221,886709168,626644631,534292189,238567972,6875812,1040521201,112210373,354501425,1397876673,802630371,1957951622,1281555621,1510443638,511532074,1305327258,676332338,749500589,1178254857,1560142089,621965568,53111869,754063383,1425899680,1375151713,33345696,284733126,837662786,941134725,1300114081,1698165455,139328482,1818135153,1156877381,13344517,1590195901,1723254447,1962037159,1803331672,437880403,987089903,1420885026,896769172,1526987474,682192419,1670035332,884780586,1568663158,888276994,1363461563,1309608240,867893051,688003346,373456104,389637246,871456090,324605514,1618441318,1525011233,821750736,685833472,207345047,1150040251,1762625722,959040265,1389600544,1656692116,1907915038,1156382401,387370996,894295922,877026491,952977738,1658303833,81178949,1010086048,1029168481,1405411138,760235132,1790276212,1338480454,968873234,577707063,1132331781,1253032784,1926213560,763083767,867847061,1372408906,1725589553,528106193,213822218,188228183,1051633919,30973540,85520238,745567443,1025320964,433363166,1118851678,1045112070,1781034992,1848286161,107391620,1361847588,103938049,1697541733,833027130,89987149,141963699,56822139,1558084778,1889235853,428389480,15300202,1133465639,1643323864,182713568,240266616,712780897,1269654466,1078703653,700144058,245001141,782212278,162569644,13857053,1780001542,589362834,1489982273,1081651547,706705140,1562491719,883598548,476785313,1447120979,1688292992,1839721644,546101028,632956766,555474033,1734939669,80488398,267481371,1058328356,1335168605,1014818657,792922881,1694227525,1272071464,1949745927,1293996389,1822084872,996980981,1006450900,1778864945,1970170050,1133559067,1883533360,1308169736,355161514,142475368,56068203,1809160284,903325095,817594857,1943126150,965119133,645512472,720987022,275863503,1980922134,12054035,801359010,1668219953,541078383,39006729,574895095,1995303655,1072663348,333348406,1135468279,1552035652,1873813740,1209402096,1828700932,813035465,1458275221,1089535450,1869158230,1105219185,632307269,297348833,998226890,612604056,1958052575,1655683438,1607212652,1670562763,829462100,1449175911,620272574,1808667054,1012321802,374231989,1865810284,65877690,788009880,479643211,1583283820,1748919014,699515475,254083829,1816838004,237284525,1443160713,935564493,23633921,1107006424,453044333,1303048931,1310613906,84783072,879692538,314031638,903071326,1224493768,1620274954,259990492,153553016,767619685,80896513,447025678,1002697578,1558331580,1022717930,127585301,258156845,1458584472,1564735989,372850155,96459230,1717288929,95180777,641161310,151733460,101556554,339267131,703949614,1012396824,1169010899,555513461,1383444788,342090189,1136624828,512273843,1757333372,1722495033,1883788229,1580002094,307037672,1225260863,1505979565,675021125,57215814,563082174,1468893155,160664196,387248769,1597193647,753741999,1747969524,453035109,238158033,1720079772,773734328,1429475379,483231273,1785713363,1434698727,284781996,357750605,119164932,1418047134,753968410,572353793,815948501,895081193,1612261491,859274992,1293161637,1677326655,393772826,101550311,447446673,314958439,44930325,965539059,1559112192,383927412,337365292,987917115,781914252,945005041,1157918488,1047303909,1579928968,1648603316,222966676,1576624857,1897698497,1743369512,1008607928,1953822549,1043200152,594082126,1855625757,1483085265,1253157473,1091550667,525095785,1877827897,1111490548,698708447,745327560,1916054910,365464711,1057039862,410289269,552987668,1233882733,451607186,1948429938,1204916963,1153228411,383662233,1140415030,1204867538,433274109,1136361683,1033909457,1967555972,932485363,533981870,367886648,144050002,1233974260,1643374051,307330537,1769974603,492193695,566667538,814558356,1535745785,780590067,1253385028,970749909,1208225598,943408063,1227362587,7239576,1451218740,1380387124,1735314746,442663120,1694197549,1786039890,22699232,776847217,899826862,1617692790,1639503654,1814872686,57862589,425747660,817164608,1236200181,153643884,148067651,1417341329,1148232192,987362196,437383117,61759636,630543901,1651633766,1897776532,578002133,74824193,1911392484,1788014474,614158226,1306584701,1026976343,1367519065,656677752,802097049,205464791,327944253,868465439,178513822,510232400,496499611,1182739771,250320943,867896551,1114000748,866721598,1684113404,1989171355,1582545794,930737169,853080741,1736159171,635150134,1445543349,687854245,1591868645,880296249,741284395,360782009,794925000,1704373040,1177071404,1501257272,194680075,1085498432,322592688,328679454,1271979246,1820436127,1245965875,140380454,1072182618,1903066312,1503762512,1135893813,718460994,879484832,1105451879,822046445,647451230,181677979,1835270294,97225298,349487732,1184855149,29030959,303565093,290645482,1144631376,614784099,1663757314,1456444933,707950755,1696923064,240468644,1719096234,1165582184,1222701132,1167284908,1834583378,898699375,260422809,1788539383,1162635753,101048242,139551447,968476033,1563048260,646701371,1542551789,1548158205,534363145,11714908,598641167,443965642,1085451060,584812660,278544960,1825471285,328812752,870794074,1375407419,868892482,1408150319,1831059428,259022933,793841130,950685755,1790796173,1237948189,66523614,170755310,1489181300,418766553,1345932983,1576403392,1119246100,681674361,1474805404,1495416753,675087554,698496494,1430166512,851803404,34035242,215441000,1198165145,1965786471,1029590749,593215519,1823671453,713565615,1619576517,1985823890,771042449,1553262309,406076512,108185831,507827662,328223772,276671143,833746135,988367709,1027960630,1883997779,329102740,1071221608,356694113,1627385149,321248076,712480940,1085253475,1161399113,1137484858,1743019216,1189714107,1584634878,1945446811,246966762,89106774,963246812,1620893451,927602252,1940461284,1743585791,54976270,819226405,902265802,490548794,923098859,757243142,160391234,1637233675,68979373,432005788,798105100,1812774000,1073998783,1790007048,360032653,589368243,773234032,1775065580,1807815531,1914958476,1055373161,574080962,125010994,926236509,1924063389,1902402166,547064827,615945822,1133815847,1508304178,189125314,1613422987,518719358,1497229204,1240114644,395256986,562076927,1354900024,161122063,82707497,706209979,423915928,1032364725,878300020,1159698462,1772571537,1229732772,654700641,1113754305,797657948,195607534,1439447705,341112594,28304589,952360318,1190931138,966949473,1145587068,1905248264,1454758695,767994256,460450355,1793793391,445266805,463901690,501722016,963468346,520241662,490226074,727578296,783596876,194302415,1729008137,535249191,83159259,1108745947,205791513,1933334833,151211130,133937387,41279625,1536334074,1453377230,1462586026,223520667,1117052852,1907645142,1575288685,28498758,805562041,835571782,1301164220,236394088,921513768,1276391068,674130360,1849113057,864033026,1041016634,1423996200,1786706219,225736958,1721954730,679128350,127028616,477446645,530318791,785340294,91539069,1919893766,1800075485,1925885439,338787233,2083526,1219632324,92741540,1440728054,1150326451,4574566,577167182,325446350,1371690581,474720981,182003142,416329643,901715725,21426265,45046440,920928994,1031458695,1594752589,1085460394,1133634221,928449644,1479832641,1806371078,311261032,649614872,1181766896,520822884,1562219694,325579036,1160760266,1029353048,896523140,1105144264,1484263021,1086899764,239165362,268702388,1349143833,1091055632,1156900053,1968469090,232716746,492777757,76236670,1134873209,426106079,260652023,1649048322,535741784,1117443465,1464502020,747571269,234841425,296246686,559509883,5804222,1401641550,674181450,641259551,1607276001,891115810,1353797562,531101080,521842864,516531479,111085282,457019967,1504997667,1895092286,180904022,910105784,761271585,1470501796,1042303639,1943612567,1140522853,1292749782,1298375082,1791848059,501872888,311238117,1406497781,1863732103,98247344,1540849949,585472563,1179646776,38380901,589302268,1653138130,1264901303,1644356754,1066332351,28677626,516102119,277530925,297625211,268371194,1786940998,822903225,1778007112,1454113281,528659565,896420058,1825773414,1523389384,750156153,126513659,1873186933,1023755135,1799722549,1149446517,830388492,203634379,69665834,675082017,856823456,828963142,175949348,597645447,174183429,829867076,134426091,1952986960,661050587,1369130124,653982168,1389431213,239095298,1093444802,519241877,490412402,394603308,1779080629,1196706923,175902425,208927574,1835709882,315738638,331697776,983542537,645659162,1952050009,687504180,1477282862,317922887,1042247717,1648686935,774877292,60642870,1354546953,1632758634,1662778776,845528756,696690339,1228419804,232834560,304837551,858961000,321009011,274276306,618197247,1574924031,1498558757,174785946,893121698};

void mul(int64_t a[2], int64_t b[2]) {
    int64_t t[2] {};
    t[0] = (a[0] * b[0] + a[1] * b[1]) % P;
    t[1] = (a[0] * b[1] + a[1] * b[0] + 2 * a[1] * b[1] % P) % P;
    a[0] = t[0];
    a[1] = t[1];
}

int64_t linear(int64_t n) {
    if (n == 0) {
        return 1;
    }
    int64_t a[2] {}, b[2] {};
    a[1] = b[0] = 1;
    for (; n > 0; n /= 2, mul(a, a)) {
        if (n % 2 == 1) {
            mul(b, a);
        }
    }
    return b[1];
}

int64_t count(int n, int l, int r) {
    int64_t ans = linear(n + (l > 0) + (r > 0));
    if (l == -2) {
        if (r > 0 || n > 0) {
            ans = 3 * ans % P;
        } else {
            ans = 2 * ans % P;
        }
    }
    if (l == -1 && (r > 0 || n > 0)) {
        ans = 2 * ans % P;
    }
    if (r == -1 && (l > 0 || n > 0)) {
        ans = 2 * ans % P;
    }
    return ans;
}

int64_t count(int n, int m, const std::vector<int> &x, const std::vector<int> &y) {
    std::vector<int> p(m);
    std::iota(p.begin(), p.end(), 0);
    std::sort(p.begin(), p.end(), [&](int i, int j) {
        return std::min(x[i], y[i]) < std::min(x[j], y[j]);
    });
    
    for (int i = 0; i < m; ++i) {
        if (y[i] > x[i] + 2) {
            return 0;
        }
    }
    
    int64_t ways = 1;
    int last = -1;
    int type = 0;
    for (int l = 0; l < m; ) {
        int r = l;
        int R = std::max(x[p[l]], y[p[l]]);
        while (r < m && std::min(x[p[r]], y[p[r]]) <= R) {
            R = std::max({R, x[p[r]], y[p[r]]});
            ++r;
        }
        int r0 = 0, r1 = 0;
        for (int i = l; i < r; ++i) {
            if (x[p[i]] == y[p[i]]) {
                if (r - l > 1) {
                    return 0;
                }
            } else if (x[p[i]] < y[p[i]]) {
                if (x[p[i]] < r0 || std::min(r1, y[p[i]]) - x[p[i]] > 1) {
                    return 0;
                }
                r0 = y[p[i]];
            } else {
                if (y[p[i]] < r1 || std::min(r0, x[p[i]]) - y[p[i]] > 1) {
                    return 0;
                }
                r1 = x[p[i]];
            }
        }
        int ltype, rtype;
        if (x[p[l]] == y[p[l]] || (r - l > 1 && std::min(x[p[l]], y[p[l]]) == std::min(x[p[l + 1]], y[p[l + 1]]))) {
            ltype = 0;
        } else if (x[p[l]] < y[p[l]]) {
            ltype = 1;
        } else if (r - l == 1 && x[p[l]] == y[p[l]] + 1) {
            ltype = -2;
        } else {
            ltype = -1;
        }
        if (x[p[l]] == y[p[l]] || (r - l > 1 && r0 == r1)) {
            rtype = 0;
        } else if (r0 > r1) {
            rtype = 1;
        } else if (r - l == 1 && x[p[l]] == y[p[l]] + 1) {
            rtype = -2;
        } else {
            rtype = -1;
        }
        ways = ways * count(std::min(x[p[l]], y[p[l]]) - last - 1, type, ltype) % P;
        if (rtype == -2 && type <= 0 && std::min(x[p[l]], y[p[l]]) - last - 1 == 0) {
            rtype = -1;
        }
        type = rtype;
        last = std::max({r0, r1, x[p[l]]});
        l = r;
    }
    ways = ways * count(n - last - 1, type, 0) % P;
    return ways;
}

int64_t factorial(int n) {
    int64_t ans = Fac[n / 500000];
    for (int64_t i = n / 500000 * 500000 + 1; i <= n; ++i) {
        ans = ans * i % P;
    }
    return ans;
}

int main() {
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    
    int t;
    std::cin >> t;
    while (t--) {
        int n, m;
        std::cin >> n >> m;
        std::vector<int> x(m), v(m);
        for (int i = 0; i < m; ++i) {
            std::cin >> x[i] >> v[i];
            --x[i], --v[i];
        }
        std::vector<std::pair<int, int>> p;
        for (int i = 0; i < m; ++i) {
            p.emplace_back(x[i], v[i]);
        }
        std::sort(p.begin(), p.end());
        p.erase(std::unique(p.begin(), p.end()), p.end());
        m = p.size();
        x.resize(m);
        v.resize(m);
        for (int i = 0; i < m; ++i) {
            std::tie(x[i], v[i]) = p[i];
        }
        if (std::set<int>(x.begin(), x.end()).size() < x.size() || std::set<int>(v.begin(), v.end()).size() < v.size()) {
            std::cout << 0 << "\n";
            continue;
        }
        for (int i = 0; i < m; ++i) {
            int x, y;
            std::tie(x, y) = p[i];
            if (y < x) {
                auto it = std::lower_bound(p.begin(), p.begin() + m, std::make_pair(y, 0));
                if (it != p.end() && it->first == y && it->second < y) {
                    p.emplace_back(y - 1, y + 1);
                }
            }
        }
        std::sort(p.begin(), p.end());
        p.erase(std::unique(p.begin(), p.end()), p.end());
        x.resize(p.size());
        v.resize(p.size());
        for (int i = 0; i < int(p.size()); ++i) {
            std::tie(x[i], v[i]) = p[i];
        }
        if (std::set<int>(x.begin(), x.end()).size() < x.size() || std::set<int>(v.begin(), v.end()).size() < v.size()) {
            std::cout << factorial(n - m) << "\n";
            continue;
        }
        int64_t ans = count(n, x.size(), x, v);
        ans = (factorial(n - m) - ans + P) % P;
        std::cout << ans << "\n";
    }
    
    return 0;
}